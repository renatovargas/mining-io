---
title: "Data Processing"
format: html
---

# Introduction

In this session, we develop input-output analysis frameworks for the mining sector of Brazil, Chile, Peru, and South Africa. During the first analysis phase, we run employment and value added multipliers for value-added and employment. Ultimately, our objective is to disaggregate the matrices regionally and to separate the information from a single company from the rest of the input-output matrix.

## Preamble

We first clean the workspace and call the appropriate libraries.

```{r}
#| warning: false
#| message: false
#| label: libraries

# Clean workspace
rm(list = ls())

# Load libraries
library(tidyverse)
library(haven)
library(readxl)
library(openxlsx)
```

## Datasets

We identify data files.

```{r}
#| warning: false
#| message: false
#| label: datasets-files

xlsx_files <- c(
    "data/PER/PER_IO_Framework.xlsx",
    "data/CHL/CHI_MIP_2022_Short_Framework.xlsx")
```


# Models

Z <- as.matrix(
    read.xlsx(
        xlsx_files[1],
        sheet = "MIP_Basico_2007_Corrientes_101_",
        rows= c(12:264),
        cols = c(4:256),
        skipEmptyRows = FALSE,
        colNames = FALSE,
        rowNames = FALSE))

```{r}
Z <- as.matrix(read_excel(
    xlsx_files[1],
    sheet = "MIP_Basico_2007_Corrientes_101_",
    range = "N12:DJ112",
    col_names = F,
    col_types = "numeric",
    trim_ws = F,
))

sectors <- read_excel(
    xlsx_files[1],
    sheet = "MIP_Basico_2007_Corrientes_101_",
    range = "L12:M112",
    col_names = F,
    col_types = "text"
)

colnames(Z) <- as.vector(sectors$...1)
rownames(Z) <- as.vector(sectors$...1)
```
